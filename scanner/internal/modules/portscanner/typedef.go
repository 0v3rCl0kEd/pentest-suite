package portscanner

import (
	"go.mongodb.org/mongo-driver/bson/primitive"
	"golang.org/x/sync/semaphore"
	"time"
)

type Task struct {
	c  chan struct{}
	ps *PortScanner
}

type PortScanner struct {
	ip      string
	lock    *semaphore.Weighted
	results []int
}

type Scan struct {
	ID        primitive.ObjectID `bson:"_id,omitempty"`
	IP        string             `bson:"ip,omitempty"`
	Date      time.Time          `bson:"date,omitempty"`
	OpenPorts []int              `bson:"openPorts,omitempty"`
}
