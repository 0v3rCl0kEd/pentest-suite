package whois

import (
	"github.com/likexian/whois"
)

func NewScan(domain string) *Task {
	task := &Task{
		c:      make(chan struct{}, 1),
		domain: domain,
	}

	go func() {
		task.result = Whois(task.domain)
		task.c <- struct{}{}
	}()

	return task
}

func (task *Task) IsDone() bool {
	if len(task.c) == 1 {
		return true
	}
	return false
}

func (task *Task) GetData() string {
	return task.result
}

func (task *Task) SaveResults() {
	SaveResults(task.GetData(), task.domain)
}

func Whois(domain string) string {
	result, err := whois.Whois(domain)
	if err != nil {
		return ""
	}
	return result
}
