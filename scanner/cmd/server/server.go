package main

import (
	"github.com/0v3rCl0kEd/pentest-suite/scanner/internal/config"
	"github.com/0v3rCl0kEd/pentest-suite/scanner/internal/db"
	"github.com/0v3rCl0kEd/pentest-suite/scanner/internal/modules/portscanner"
	"github.com/0v3rCl0kEd/pentest-suite/scanner/internal/modules/sherlock"
	"github.com/0v3rCl0kEd/pentest-suite/scanner/internal/modules/whois"
	"github.com/0v3rCl0kEd/pentest-suite/scanner/internal/utils/filetools"
	"github.com/0v3rCl0kEd/pentest-suite/scanner/internal/webserver"
)

func main() {
	filetools.Mkdir(filetools.AppPath())
	config.ReadConfig()
	db.Connect(config.Conf.GetString("mongo.auth"))

	InstallModules()

	sherlock.SetupDB()
	portscanner.SetupDB()
	whois.SetupDB()

	webserver.Initialize()
}

func InstallModules() {
	sherlock.Install()
}
