package main

import (
	"fmt"
	"github.com/0v3rCl0kEd/pentest-suite/scanner/internal/config"
	"github.com/0v3rCl0kEd/pentest-suite/scanner/internal/db"
	"github.com/0v3rCl0kEd/pentest-suite/scanner/internal/modules/sherlock"
	"github.com/0v3rCl0kEd/pentest-suite/scanner/internal/utils/filetools"
	"time"
)

func main() {
	filetools.Mkdir(filetools.AppPath())
	config.ReadConfig()
	db.Connect(config.Conf.GetString("mongo.auth"))

	InstallModules()

	sherlock.SetupDB()

	scan := sherlock.NewScan("0v3rCl0kEd")
	for {
		if scan.IsDone() {
			fmt.Println()
			fmt.Println("DONE")
			sherlock.SaveResults(scan.GetData())
			break
		}
		fmt.Print(".")
		time.Sleep(100 * time.Millisecond)

	}

}

func InstallModules() {
	sherlock.Install()
}
